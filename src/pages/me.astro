---
import Layout from "@layouts/Layout.astro";
import { Image } from "astro:assets";
import Container from "@components/Container.astro";
import Link from "@components/Link.astro";
import CertificationBadge from "@components/CertificationBadge.astro";
import { SITE, SOCIALS, WORK_EXPERIENCE, EDUCATION, SKILLS, CERTIFICATIONS } from "@consts";

import WonderfulPartner from "@assets/wonderful_partner.png";
import Work from "@assets/work.jpeg";
import OSCPLogo from "@assets/certifications/oscp.png";
import CPSALogo from "@assets/certifications/cpsa.png";
import CRTLogo from "@assets/certifications/crt.png";

const certLogos: Record<string, typeof OSCPLogo> = {
  OSCP: OSCPLogo,
  CPSA: CPSALogo,
  CRT: CRTLogo,
};
---

<Layout title="About Me" description="Tentang Rafi Priatna - Cyber Security Consultant">
  <Container>
    <div class="pt-8 md:pt-12 space-y-16">
      <!-- Intro -->
      <section>
        <h1 class="section-heading">about</h1>
        <div class="space-y-5 text-[15px] text-text-secondary leading-relaxed">
          <p>
            Saya <span class="text-text-primary font-medium">Rafi Priatna</span>, seorang 
            <span class="text-accent">Cyber Security Consultant</span> yang memiliki passion 
            dalam memahami bagaimana sistem bekerja dan bagaimana mereka bisa di-compromise.
          </p>
          <p>
            Security engineering bukan hanya tentang menemukan vulnerability — ini tentang 
            memahami root cause dan memberikan solusi yang tepat.
          </p>
          <p>
            Di luar pekerjaan, saya suka melakukan bug hunting, menulis dokumentasi teknis, 
            dan membangun lab security. Saya juga menikmati bermain game offline 
            seperti Stardew Valley, dan menghabiskan waktu dengan partner saya.
          </p>
        </div>
      </section>

      <!-- Photos -->
      <section>
        <div class="flex flex-col sm:flex-row gap-4">
          <Image
            src={Work}
            alt="Work setup"
            width={350}
            height={250}
            class="h-[220px] w-full sm:w-auto sm:flex-1 rounded-md object-cover border border-surface-border"
          />
          <Image
            src={WonderfulPartner}
            alt="Wonderful partner"
            width={250}
            height={350}
            class="h-[280px] w-full sm:w-[200px] rounded-md object-cover border border-surface-border"
          />
        </div>
      </section>

      <!-- Certifications -->
      <section>
        <h2 class="section-heading">certifications</h2>
        <div class="space-y-4">
          {
            CERTIFICATIONS.map((cert) => (
              <div class="flex flex-col sm:flex-row sm:items-center gap-3 py-3 border-b border-surface-border/30 last:border-0">
                <div class="shrink-0">
                  <CertificationBadge
                    name={cert.name}
                    logo={certLogos[cert.name]}
                    url={cert.url}
                  />
                </div>
                <div class="min-w-0">
                  <p class="text-[15px] text-text-primary font-medium">{cert.fullName}</p>
                  <p class="text-xs text-text-muted font-mono mt-0.5">
                    {cert.issuer}
                    {cert.year && <span> · {cert.year}</span>}
                  </p>
                </div>
              </div>
            ))
          }
        </div>
      </section>

      <!-- Work Experience (detail) -->
      <section>
        <h2 class="section-heading">work experience</h2>
        <div class="space-y-8">
          {
            WORK_EXPERIENCE.map((job) => (
              <div class="border-b border-surface-border/30 pb-8 last:border-0 last:pb-0">
                <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between gap-1 sm:gap-4 mb-2">
                  <div>
                    <p class="text-[15px] text-text-primary font-semibold">{job.role}</p>
                    <p class="text-sm text-text-muted font-mono">{job.company}</p>
                  </div>
                  <span class="text-xs text-text-muted font-mono shrink-0">{job.period}</span>
                </div>
                {job.description && (
                  <p class="text-[15px] text-text-secondary leading-relaxed mb-3">{job.description}</p>
                )}
                {job.highlights && job.highlights.length > 0 && (
                  <ul class="space-y-1.5 text-[15px] text-text-secondary">
                    {job.highlights.map((item) => (
                      <li class="flex items-start gap-2">
                        <span class="text-accent text-xs mt-1.5 font-mono shrink-0">&gt;</span>
                        <span>{item}</span>
                      </li>
                    ))}
                  </ul>
                )}
              </div>
            ))
          }
        </div>
      </section>

      <!-- Education -->
      {EDUCATION.length > 0 && (
        <section>
          <h2 class="section-heading">education</h2>
          <div class="space-y-3">
            {
              EDUCATION.map((edu) => (
                <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between gap-1 py-2 border-b border-surface-border/30 last:border-0">
                  <div>
                    <p class="text-[15px] text-text-primary font-medium">{edu.degree}</p>
                    <p class="text-xs text-text-muted font-mono mt-0.5">{edu.institution}</p>
                    {edu.description && (
                      <p class="text-sm text-text-secondary mt-2 leading-relaxed">{edu.description}</p>
                    )}
                  </div>
                  <span class="text-xs text-text-muted font-mono shrink-0">{edu.period}</span>
                </div>
              ))
            }
          </div>
        </section>
      )}

      <!-- Skills -->
      {SKILLS.length > 0 && (
        <section>
          <h2 class="section-heading">skills</h2>
          <div class="flex flex-wrap gap-4">
            {
              SKILLS.map((group) => (
                <div>
                  <p class="text-xs font-mono text-text-muted uppercase tracking-wider mb-2">{group.title}</p>
                  <div class="flex flex-wrap gap-1.5">
                    {group.items.map((item) => (
                      <span class="text-sm px-2 py-1 rounded border border-surface-border/50 bg-surface-light/50 text-text-secondary font-mono">
                        {item}
                      </span>
                    ))}
                  </div>
                </div>
              ))
            }
          </div>
        </section>
      )}

      <!-- Now -->
      <section>
        <h2 class="section-heading">now</h2>
        <ul class="space-y-2.5 text-[15px] text-text-secondary">
          <li class="flex items-start gap-2.5">
            <span class="text-accent text-xs mt-1.5 font-mono">&gt;</span>
            <span>Fulltime <span class="text-text-primary">Cyber Security Consultant</span></span>
          </li>
          <li class="flex items-start gap-2.5">
            <span class="text-accent text-xs mt-1.5 font-mono">&gt;</span>
            <span><span class="text-text-primary">Bug Hunting</span> jika sempat</span>
          </li>
          <li class="flex items-start gap-2.5">
            <span class="text-accent text-xs mt-1.5 font-mono">&gt;</span>
            <span>Membuat lab di <Link href="https://www.hacktrace-ranges.id/" external class="text-accent">HackTrace Ranges</Link></span>
          </li>
          <li class="flex items-start gap-2.5">
            <span class="text-accent text-xs mt-1.5 font-mono">&gt;</span>
            <span>Tweaking website ini</span>
          </li>
        </ul>
      </section>

      <!-- Speaking -->
      <section>
        <h2 class="section-heading">speaking</h2>
        <div class="space-y-3">
          <div class="flex items-baseline justify-between gap-4 py-2 border-b border-surface-border/30">
            <div>
              <p class="text-[15px] text-text-primary font-medium">How to Start a Career in Cyber Security</p>
              <p class="text-xs text-text-muted font-mono mt-1">CCUG x LinuxHacking.ID</p>
            </div>
            <span class="text-xs text-text-muted font-mono shrink-0">2024</span>
          </div>
        </div>
      </section>

      <!-- Contact -->
      <section class="pb-8">
        <h2 class="section-heading">contact</h2>
        <div class="space-y-2.5 text-sm font-mono">
          <div class="flex items-center gap-3">
            <span class="text-text-muted text-xs w-12">email</span>
            <Link 
              href={`mailto:${SITE.USER_EMAIL}@${SITE.DOMAIN}`}
              underline={false}
              class="text-text-secondary hover:text-accent transition-colors duration-200"
            >
              {SITE.USER_EMAIL}@{SITE.DOMAIN}
            </Link>
          </div>
          <div class="flex items-center gap-3">
            <span class="text-text-muted text-xs w-12">social</span>
            <div class="flex items-center gap-2">
              {
                SOCIALS.map((SOCIAL, index) => (
                  <>
                    <Link
                      href={SOCIAL.HREF}
                      external
                      underline={false}
                      class="text-text-secondary hover:text-accent transition-colors duration-200 text-sm"
                      aria-label={`${SITE.TITLE} on ${SOCIAL.NAME}`}
                    >
                      {SOCIAL.NAME.toLowerCase()}
                    </Link>
                    {index < SOCIALS.length - 1 && <span class="text-surface-border">·</span>}
                  </>
                ))
              }
            </div>
          </div>
        </div>
      </section>
    </div>
  </Container>
</Layout>
